<!doctype html>
<html lang="id" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="theme-color" content="#343a40">
	<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com/">
	<link rel="icon" href="assets/icon.png" type="image/x-icon">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv='cache-control' content='no-cache'>
	<meta http-equiv='expires' content='0'>
	<meta http-equiv='pragma' content='no-cache'>
	<title>JFP – Data Harian COVID-19 NTT</title>
	<noscript><meta http-equiv="refresh" content="0; url=no-js.html"/></noscript>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" onload="if(media!='all')media='all'">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;400;500;700&display=swap" onload="if(media!='all')media='all'">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-167603452-2"></script>
<script>
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-167603452-2');
</script>
	<style>
body{font-family:"Roboto",sans-serif;}.chart-container{position:relative; min-width:100%; max-width:100%; margin-bottom:1rem;}.logoinc::before,.logodec::before,.logonet::before{display:inline-block;font-size:14px;margin-right:.25rem}.logoinc::before{content:"▲"}.logodec::before{content:"▼"}.logonet::before{content:"–"}.logoright::before{margin-right:0;margin-left:.25rem}.card{overflow:hidden}#TP_TblHarian td{vertical-align:middle;text-align:center}#TP_TblHarian td:first-child{text-align:left}.chart-container div{position:absolute;width:100%;height:100%;text-align:center;display:flex;align-items:center;justify-content:center;background: var(--light)}.anchor{position:absolute;margin-top:-4rem;}#TP_TblHarian td:nth-child(2),#TP_TblHarian td:nth-child(5),#TP_TblHarian td:nth-child(8),#TP_TblHarian td:nth-child(11) {border-left:1px solid #dee2e6}.tbl-iti{width:24px;height:24px;margin-left:.25rem}#TP_TblHarian td .flbet{display:flex;justify-content:space-between;align-items:center}
@media (max-width:576px) {.chart-container{max-height:45vh;}}
.tbl-fs{
    position: fixed;
    left: 0;
    right: 0;
    top: 3.5rem;
    bottom: 0;
    background: #fff;
    z-index: 10;
}
#ToggleFS.fs-true {
    position: fixed;
    top: .8rem;
    z-index: 1100;
    right: 1rem;
}
</style>
</head>
<body>
	<nav class="navbar navbar-dark sticky-top shadow bg-dark">
		<div class="container d-md-flex justify-content-between text-center">
			<a class="navbar-brand text-truncate">
				JollyFrankle Projects: COVID-19 NTT Tracker
			</a>
			<div class="d-none d-md-block text-light">
				Data terakhir: <strong class="LastData">Memuat...</strong>
			</div>
		</div>
	</nav>
	<main class="container my-4">
<div class="d-block d-md-flex justify-content-between align-items-center mb-2">
	<div>
		<h1>COVID-19 NTT Tracker</h1>
		<p class="mb-2">Informasi dan analisa kasus COVID-19 NTT.</p>
	</div>
	<form method="GET" style="max-width:330px" class="m-md-0 m-auto">
		<label for="RangeSel" class="mb-1">Jumlah hari untuk ditampilkan:</label>
		<div class="btn-group w-100">
			<select name="day" class="form-control custom-select" id="RangeSel">
				<option value=90>90 hari terakhir (default)</option>
				<option value=365>1 tahun terakhir</option>
				<option value=180>180 hari terakhir</option>
				<option value=60>60 hari terakhir</option>
				<option value=30>30 hari terakhir</option>
			</select>
			<input type="submit" class="btn btn-primary" value="Tampilkan"/>
		</div>
	</form>
</div>

<nav class="mb-3 pb-3 border-bottom">
    <div class="d-block d-md-inline-flex btn-group w-100">
        <a class="btn btn-block btn-outline-dark mt-2" href="./">Ringkasan, Grafik, Tabel Pekanan</a>
        <a class="btn btn-block btn-outline-dark" href="datakab.html">Data hari ini per Kab/Kota</a>
        <a class="btn btn-block btn-outline-dark active">Perkembangan data harian <span class="badge badge-info">tampilan baru</span></a>
    </div>
</nav>

<div class="btn-group w-100 mb-2">
    <button class="btn btn-sm btn-outline-danger" data-toggle="collapse" data-target="#ILL_atas" aria-expanded="false" aria-controls="ILL_atas">Disklaimer</button>
    <button class="btn btn-sm btn-outline-info" data-toggle="collapse" data-target="#InfoAtas" aria-expanded="false" aria-controls="InfoAtas">Informasi, daftar isi, halaman lain</button>
</div>
<div class="collapse" id="ILL_atas">
	<div class="alert alert-danger text-justify">
		<p><strong>DISCLAIMER:</strong> Data yang ditampilkan pada halaman ini mungkin berbeda dengan data yang disediakan pada <a href="http://covid19.nttprov.go.id/home/data" class="alert-link">halaman resmi COVID-19 NTT</a> karena data yang direkam pada halaman ini diperbarui pada pukul 17.00-21.00 WITA, sedangkan data pada halaman resmi terkadang diperbarui lagi setelah 21.00 WITA. Selain itu, kasus sembuh dan meninggal tidak menunjukkan jumlah pasien yang sembuh/meninggal dari kasus pada tanggal tertentu, melainkan jumlah pasien yang diumumkan sembuh/meninggal pada hari itu juga.</p>
		<p class="font-italic mb-0">Contoh: Apabila seseorang dinyatakan positif pada 19 Januari 2021 dan sembuh pada 1 Februari 2021, kasus sembuh akan bertambah pada 1 Februari 2021, bukan 19 Januari 2021.</p>
		<h5 class="mb-0">HALAMAN INI HANYA VISUALISASI PERKEMBANGAN KASUS COVID-19 DI NTT</h5>
	</div>
</div>

<div class="card collapse" id="InfoAtas">
	<div class="card-body text-justify">
		<h4 class="border-bottom">Informasi</h4>
		<ul class="pl-4 mb-3">
			<li>Ganti jumlah hari yang dianalisis melalui <em>dropdown</em> yang tersedia di atas halaman, di bawah judul (pada ponsel) atau sebelah kanan judul (pada PC). Saat ini menampilkan analisis dari <span class="GET_day-html">...</span> terakhir.</li>
			<li>Halaman ini memuat daftar kasus harian dari Briefing Satuan Tugas Penanganan COVID-19 Nusa Tenggara Timur. Data mungkin tidak 100% akurat, informasi pada situs Satgas mungkin diperbarui setelah pembaruan data di sistem ini.</li>
		</ul>
		<h4 class="border-bottom">Daftar isi</h4>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">1.</div>
				<a class="h5 mb-1" href="#Bg1_Harian">Data Historis Provinsi NTT</a>
			</div>
			Perkembangan kasus COVID-19 harian untuk seluruh Nusa Tenggara Timur selama <span class="GET_day-html">...</span> terakhir. Terdapat pula jumlah pertambahan kasus selama satu pekan tersebut.
		</div>
		<div class="pl-4 mb-3">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.</div>
				<a class="h5 mb-1" href="#Bg2_Excel">Data Historis Per Wilayah</a>
			</div>
			Salinan dari situs resmi COVID-19 NTT sejak April 2020 hingga saat ini.
		</div>
		<h4 class="border-bottom">Halaman lain</h4>
		<div class="pl-4">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">1.</div>
				<a class="h5 mb-1" href="index.html">Beranda: Analisis dan grafik COVID-19 NTT</a>
			</div>
			Tersedia analisis harian, rekapitulasi data pekanan, dan grafik visualisasi perkembangan kasus COVID-19 Nusa Tenggara Timur.
		</div>
		<div class="pl-4">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.</div>
				<a class="h5 mb-1" href="datakab.html">Kasus Per Wilayah</a>
			</div>
			Perkembangan data hari ini per Kabupaten/Kota di Nusa Tenggara Timur.
		</div>
	</div>
</div>

<div id="Bg1_Harian" class="anchor"></div>
<h2 class="border-bottom"><small>1.</small> Data Historis Provinsi NTT</h2>
<div class="alert alert-info">
	<p>Lambang warna yang ditampilkan di sebelah kanan indikator penambahan kasus merupakan indikator seberapa tingginya peningkatan kasus pada hari itu dibandingkan penambahan kasus terbanyak sepanjang <span class="GET_day-html">...</span> terakhir. Semakin gelap/<em>solid</em> warna, semakin tinggi peningkatan.</p>
	<p>Perubahan 7 hari (Prb. 7 hari) dihitung dari rata-rata kasus 7 hari terakhir dan 7 hari terdahulu.</p>
	<p class="mb-0"><strong>Tips:</strong> Tabel ini cukup panjang ke samping, gunakan arah panah (pada keyboard) untuk menavigasi atau masuk ke mode layar penuh.</p>
	<p class="small">Untuk keluar mode layar penuh, klik pada tombol "Layar Penuh" yang akan ada di kanan atas layar.</p>
	<button class="btn btn-sm btn-light fs-false" id="ToggleFS">Layar Penuh</button>
</div>
<div class="table-responsive mb-3" id="TblHarianWrapper">
	<table class="table table-hover mb-0" id="TP_TblHarian" style="min-width:1250px">
		<thead class="bg-light">
			<tr>
				<th rowspan=2 style="width:225px">Hari, Tanggal</th>
				<th colspan=3 style="border-left:1px solid #dee2e6">Kasus Positif</th>
				<th colspan=3 style="border-left:1px solid #dee2e6">Sembuh</th>
				<th colspan=3 style="border-left:1px solid #dee2e6">Meninggal</th>
				<th colspan=2 style="border-left:1px solid #dee2e6">Kasus Aktif</th>
			</tr>
			<tr>
				<th style="border-left:1px solid #dee2e6">Baru</th>
				<th>Prb. 7 hari</th>
				<th>Jumlah</th>
				<th style="border-left:1px solid #dee2e6">Baru</th>
				<th>Prb. 7 hari</th>
				<th>Jumlah</th>
				<th style="border-left:1px solid #dee2e6">Baru</th>
				<th>Prb. 7 hari</th>
				<th>Jumlah</th>
				<th style="border-left:1px solid #dee2e6">%</th>
				<th>Jumlah</th>
			</tr>
		</thead>
		<tbody>
			<tr><td colspan=10 class="text-center">Memuat data...</td></tr>
		</tbody>
	</table>
</div>

<div id="Bg2_Excel" class="anchor"></div>
<h2 class="border-bottom"><small>2.</small> Data Historis Per Wilayah</h2>
<div class="alert alert-info">
    <p>Di bawah ini merupakan data historis per wilayah (Kabupaten/Kota) di NTT. Gunakan berbagai tab di bawah untuk melihat data historis yang dapat direkam selama bulan tersebut.</p>
    <p class="mb-0">Data mulai konsisten direkam sejak 19 November 2020. Data April - Oktober 2020 hanya direkam sebagian. Daftar tanggal yang direkam selama April-Oktober 2020 adalah:</p>
    <ul style="column-width:170px;margin-left:-1.25rem">
        <li>27 April 2020</li>
        <li>15 Mei 2020</li>
        <li>1 Juni 2020</li>
        <li>5 Juni 2020</li>
        <li>20 Juni 2020</li>
        <li>2 Juli 2020</li>
        <li>15 Juli 2020</li>
        <li>1 Agustus 2020</li>
        <li>3 Agustus 2020</li>
        <li>11 Agustus 2020</li>
        <li>12 September 2020</li>
        <li>30 September 2020</li>
        <li>20 Oktober 2020</li>
        <li>21 Oktober 2020</li>
        <li>30 Oktober 2020</li>
    </ul>
    <p class="mb-0">Data sejak 19 November 2020 yang tidak dapat direkam karena tidak ada update dari situs resmi atau beberapa kendala adalah:</p>
    <ul style="column-width:170px;margin-left:-1.25rem" class="mb-0">
        <li>23 November 2020</li>
        <li>27 November 2020</li>
        <li>14 Desember 2020</li>
        <li>20 Desember 2020</li>
        <li>24 Desember 2020</li>
        <li>25 Desember 2020</li>
        <li>28 Desember 2020</li>
        <li>14 Maret 2021</li>
        <li>4-6 April 2021</li>
        <li>8-13 April 2021</li>
    </ul>
</div>
<ul class="nav nav-pills mb-3" id="NavDataExcel" style="flex-wrap:nowrap; overflow-x:auto; white-space:nowrap"></ul>
<div style="width:100%;height:600px" class="position-relative">
    <div class="d-flex align-items-center justify-content-center h-100 text-center">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="96" height="96" fill="currentColor" class="mb-4" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M0 0h1v15h15v1H0V0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5z"/></svg>
            <h6 class="mb-0">Klik pada salah satu bulan di atas untuk menampilkan data.</h6>
            <p class="mb-1">Silakan tunggu beberapa saat hingga data selesai dimuat.</p>
            <div class="small">Apabila halaman tidak dapat dimuat, berarti permintaan Anda ditolak oleh penyedia.</div>
        </div>
    </div>
    <iframe style="width:100%;height:600px; position:absolute; top:0" frameborder="0" scrolling="no" id="DataExcel"></iframe>
</div>
<div class="bg-dark py-1 px-3 small text-light position-relative" style="margin-top:calc(-26px)">
    Layanan Excel Online
</div>
<div id="TambahanInfo" class="alert mb-0" style="position:sticky; bottom:0; display:none; max-height:6rem">
    <h6 class="mb-1" id="TI_header"></h6>
    <p class="mb-0 small" id="TI_text"></p>
</div>
</main>
<footer class="bg-dark text-light">
	<div class="container p-3">
		<strong>Jolly Frankle @ GitHub</strong>
		<div class="small">Kontak: jollyfrankle3@gmail.com</div>
	</div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
<script>
$.ajax({
	url: "pengumuman.json",
	method: "GET",
	dataType: "json",
	success:function(data)
	{
		if(data.show) {
		    $("#TI_header").html(data.header);
		    $("#TI_text").html(data.text);
		    $("#TambahanInfo").addClass("alert-"+(data.type ?? "info")).show();
		}
	}
});
const delay = ms => new Promise(res=>setTimeout(res,ms));
const NamaBulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
const NamaHari = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
function NolAwal(num, padlen) {
	var pad_char = '0';
	var pad = new Array(1 + padlen).join(pad_char);
	return (pad + num).slice(-pad.length);
}
var url = new URL(window.location.href);
var day = url.searchParams.get("day");
$("#RangeSel").val(day?day:90);
function DateIndo(d,mode) {var t=new Date(d);var o="";o=mode==2?NamaHari[t.getDay()]+", " : ""; o+=t.getDate()+" "+NamaBulan[t.getMonth()]+" "+t.getFullYear(); return o;}
Date.prototype.getWeek = function() {
	var date = new Date(this.getTime());
	date.setHours(0, 0, 0, 0);
	// Thursday in current week decides the year.
	date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
	// January 4 is always in week 1.
	var week1 = new Date(date.getFullYear(), 0, 4);
	// Adjust to Thursday in week 1 and count number of weeks from date to week1.
	return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000
	- 3 + (week1.getDay() + 6) % 7) / 7);
}
Date.prototype.getWeekYear = function() {
	var date = new Date(this.getTime());
	date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
	return date.getFullYear();
}
$("#ToggleFS").on("click",function(){
    if($(this).hasClass("fs-true")) {
        $("#TblHarianWrapper").removeClass("tbl-fs");
        $("#ToggleFS").addClass("fs-false").removeClass("fs-true");
        $("body").css("overflow","auto");
    } else {
        $("#TblHarianWrapper").addClass("tbl-fs");
        $("#ToggleFS").addClass("fs-true").removeClass("fs-false");
        $("body").css("overflow","hidden");
    }
});
//$.ajax({url: "https://raw.githubusercontent.com/JollyFrankle/jollyfrankle.github.io/main/data.js", method: "GET", dataType: "jsonp", success: AJAX_Complete});
$.getScript("data.js",AJAX_Complete);
function AJAX_Complete(){
if(day<=0) var GET_day=-90, GET_day_plain=90;
else if(day>Tanggal.length) var GET_day=-Tanggal.length, GET_day_plain=Tanggal.length;
else var GET_day=-day, GET_day_plain=day;
$(".GET_day-html").text(GET_day_plain+" hari");

function getMinMax(arr) {
	let min = arr[0];
	let max = arr[0];
	let i = arr.length;
		
	while (i--) {
		min = arr[i] < min ? arr[i] : min;
		max = arr[i] > max ? arr[i] : max;
	}
	return { min, max };
}
function rgba2rgb(background, color) {
    const alpha = color[3];
    return "rgba("+Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5)+","+
    Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5)+","+
    Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5)+")";
}
// Hijau = hsl(134 61% 41%)
// Merah = hsl(354 70% 54%)
function RYGind(per, mode) {
    if(mode==1) var h = (134+((1-per)*(354-134))).toFixed(0);
    if(mode==2) var h = (134+((per)*(354-134))).toFixed(0);
    var s = (61+((1-per)*(70-61))).toFixed(0),
    l = (41+((1-per)*(54-41))).toFixed(0);
    var h = (1-per)*120;
    return "hsl("+h+","+65+"%,"+51+"%)";
}
function TrendInd(mode,val1,val2) {
    var selisih, perc, i, c, l;
    if(val1 && val2) {
        var selisih = val1 - val2;
        var perc = selisih / val2;
        if(perc > 0) {
            i="Meningkat "; l="logoinc";
        }
        if(perc < 0) {
            i="Menurun "; l="logodec";
        }
        if(perc===0) {i="Tidak ada perubahan";c="muted";l="logonet"}
    }
	if(mode==1) {
	    if(perc > 0.5) {i+="tajam";c="danger"}
	    if(perc > 0.1 && perc <= 0.5) {c="danger"}
	    if(perc > 0.0 && perc <= 0.1) {i+="tipis";c="muted"}
	    if(perc < 0.0 && perc >=-0.1) {i+="tipis";c="muted"}
	    if(perc <-0.1 && perc >=-0.5) {c="success"}
	    if(perc <-0.5) {i+="tajam";c="success"}
	}
	if(mode==2) {
	    if(perc > 0.5) {i+="tajam";c="success"}
	    if(perc > 0.1 && perc <= 0.5) {c="success"}
	    if(perc > 0.0 && perc <= 0.1) {i+="tipis";c="muted"}
	    if(perc < 0.0 && perc >=-0.1) {i+="tipis";c="muted"}
	    if(perc <-0.1 && perc >=-0.5) {c="danger"}
	    if(perc <-0.5) {i+="tajam";c="danger"}
	}
	if(mode==3) {
	    if(val1 > 0) {i="Meningkat";c="danger";l="logoinc"}
	    if(val1===0) {i="Stabil";c="muted";l="logonet"}
	    if(val1 > 0) {i="Menurun";c="success";l="logodec"}
	}
	if(mode==4) {
	    if(val1 > 0) {i="Meningkat";c="success";l="logoinc"}
	    if(val1===0) {i="Stabil";c="muted";l="logonet"}
	    if(val1 > 0) {i="Menurun";c="danger";l="logodec"}
	}
	return [i,c,l];
}
$(".LastData").text(DateIndo(Tanggal[Tanggal.length-1]));
$("#TP_TblHarian tbody").html(""); var PersAktfYest=null, $RMK=0, $RMS=0, $RMM=0, $RMKy=null, $RMSy=null, $RMMy=null, $day=0;
var $ArrKB=KonfBaru.slice(GET_day), $ArrKJ=KonfJuml.slice(GET_day), $ArrK7=Konf7day.slice(GET_day),
$ArrSB=SembBaru.slice(GET_day), $ArrSJ=SembJuml.slice(GET_day), $ArrS7=Semb7day.slice(GET_day),
$ArrMB=MengBaru.slice(GET_day), $ArrMJ=MengJuml.slice(GET_day), $ArrM7=Meng7day.slice(GET_day),
HL_KB = getMinMax($ArrKB), HL_SB = getMinMax($ArrSB), HL_MB = getMinMax($ArrMB),
HL_K7 = getMinMax($ArrK7), HL_S7 = getMinMax($ArrS7), HL_M7 = getMinMax($ArrM7);
var BulanTahun=[];
$.each(Tanggal, function(key,val){
    if(!BulanTahun.includes(val.substr(0,7))) {
        BulanTahun.push(val.substr(0,7));
        var tgl=new Date(val.substr(0,7));
        $("#NavDataExcel").prepend('<li class="nav-item"><a class="nav-link" href="javascript:void(0)" data-xlsx="'+val.substr(0,7)+'">'+NamaBulan[tgl.getMonth()]+" "+tgl.getFullYear()+'</a></li>');
    }
});
$(document).on("click", "#NavDataExcel a", function(){
    if($(this).data("xlsx")) {
        $("#DataExcel").removeAttr("src");
        $("#DataExcel").prop("src", "https://onedrive.live.com/embed?resid=C9E7642AA34CF44A%2112171&authkey=%21AP-NSamXtCTCXys&em=2&wdAllowInteractivity=False&ActiveCell=%27"+$(this).data("xlsx")+"%27!A1&Item=%27"+$(this).data("xlsx")+"%27!A1%3AU810&wdHideGridlines=True&wdInConfigurator=True");
        $("#NavDataExcel a").removeClass("active");
        $(this).addClass("active");
    }
});
$.each(Tanggal.slice(GET_day),function(key,val){
	var PersAktf=(($ArrKJ[key]-($ArrSJ[key]+$ArrMJ[key]))/$ArrKJ[key])*100,
	PAind = TrendInd(1, PersAktf, PersAktfYest);
	K7dind = TrendInd(1, $ArrK7[key], $ArrK7[key-7]);
	S7dind = TrendInd(2, $ArrS7[key], $ArrS7[key-7]);
	M7dind = TrendInd(1, $ArrM7[key], $ArrM7[key-7]);
	
	$RMK+=$ArrKB[key]; $RMS+=$ArrSB[key]; $RMM+=$ArrMB[key];
	var HL_KBind="rgba(191,144,0,"+($ArrKB[key]-HL_KB["min"])/HL_KB["max"]+")",
	HL_SBind="rgba(0,32,96,"+($ArrSB[key]-HL_SB["min"])/HL_SB["max"]+")",
	HL_MBind="rgba(192,0,0,"+($ArrMB[key]-HL_MB["min"])/HL_MB["max"]+")";
	Col1="<td>"+DateIndo(val,2)+"</td>";
	ColK1="<td><div class='flbet'><strong>"+($ArrKB[key]<0?$ArrKB[key]:"+"+$ArrKB[key])+"</strong><div class='rounded tbl-iti' style='background:"+HL_KBind+"'></div></div></td>";
	ColK2="<td><div class='flbet'><div>+"+($ArrK7[key]!=null ? $ArrK7[key].toFixed(2).replace(".",",") : " –")+"</div><div class='logoright text-"+K7dind[1]+" "+K7dind[2]+"'></div></div></td>";
	ColK3="<td>"+$ArrKJ[key]+"</td>";
	ColS1="<td><div class='flbet'><strong>"+($ArrSB[key]<0?$ArrSB[key]:"+"+$ArrSB[key])+"</strong><div class='rounded tbl-iti' style='background:"+HL_SBind+"'></div></div></td>";
	ColS2="<td><div class='flbet'><div>+"+($ArrS7[key]!=null ? $ArrS7[key].toFixed(2).replace(".",",") : " –")+"</div><div class='logoright text-"+S7dind[1]+" "+S7dind[2]+"'></div></div></td>";
	ColS3="<td>"+$ArrSJ[key]+"</td>";
	ColM1="<td><div class='flbet'><strong>"+($ArrMB[key]<0?$ArrMB[key]:"+"+$ArrMB[key])+"</strong><div class='rounded tbl-iti' style='background:"+HL_MBind+"'></div></div></td>";
	ColM2="<td><div class='flbet'><div>+"+($ArrM7[key]!=null ? $ArrM7[key].toFixed(2).replace(".",",") : " –")+"</div><div class='logoright text-"+M7dind[1]+" "+M7dind[2]+"'></div></div></td>";
	ColM3="<td>"+$ArrMJ[key]+"</td>";
	ColA1="<td><div class='flbet'>"+PersAktf.toFixed(2).replace(".",",")+"%<div class='logoright text-"+PAind[1]+" "+PAind[2]+"'></div></div></td>";
	ColA2="<td>"+($ArrKJ[key]-($ArrSJ[key]+$ArrMJ[key]))+"</td>";
	$("#TP_TblHarian tbody").prepend("<tr>"+Col1+ColK1+ColK2+ColK3+ColS1+ColS2+ColS3+ColM1+ColM2+ColM3+ColA1+ColA2+"</tr>");
	$day++;
	if(new Date(val).getDay()+1==7) {
		var tgl=new Date(val), //ColRM = Kolom Rekap Mingguan
		$RMKBavg = $RMKy==null ? null : (($RMK-$RMKy)/$RMKy)*100;
		$RMKBavg = $RMKBavg===null ? "" : $RMKBavg<0 ? $RMKBavg.toFixed(2).replace(".",",")+"%" : "+"+$RMKBavg.toFixed(2).replace(".",",")+"%";
		$RMKBavgInd = TrendInd(1, $RMK, $RMKy);

		$RMSBavg = $RMSy==null ? null : (($RMS-$RMSy)/$RMSy)*100;
		$RMSBavg = $RMSBavg===null ? "" : $RMSBavg<0 ? $RMSBavg.toFixed(2).replace(".",",")+"%" : "+"+$RMSBavg.toFixed(2).replace(".",",")+"%";
		$RMSBavgInd = TrendInd(2, $RMS, $RMSy);

		$RMMBavg = $RMMy==null ? null : (($RMM-$RMMy)/$RMMy)*100;
		$RMMBavg = $RMMBavg===null ? "" : $RMMBavg<0 ? $RMMBavg.toFixed(2).replace(".",",")+"%" : "+"+$RMMBavg.toFixed(2).replace(".",",")+"%";
		$RMMBavgInd = TrendInd(1, $RMM, $RMMy);

		var info_tgl = $day<7 ? "<div class='small'>Hanya menampilkan data "+$day+" hari terakhir</div>" : "";
		ColRMTgl="<td><span class='text-info h6 mb-0'>Pekan ke-"+tgl.getWeek()+" tahun "+tgl.getWeekYear()+"</span>"+info_tgl+"</td>";
		ColNone="<td class='d-none'></td>";
		ColRMKB="<td colspan=3><div class='flbet fw-500'><strong style='color:#BF9000'>+"+$RMK+" ks.</strong><div class='flbet text-"+$RMKBavgInd[1]+"'>"+$RMKBavg+"<div class='logoright "+$RMKBavgInd[2]+"'></div></div></div></td>";
		ColRMSB="<td colspan=3><div class='flbet fw-500'><strong style='color:#002060'>+"+$RMS+" ks.</strong><div class='flbet text-"+$RMSBavgInd[1]+"'>"+$RMSBavg+"<div class='logoright "+$RMSBavgInd[2]+"'></div></div></div></td>";
		//"<td colspan=3 style='color:#002060;text-align:left'>+<strong>"+$RMS+"</strong></td>";
		ColRMMB="<td colspan=3><div class='flbet fw-500'><strong style='color:#C00000'>+"+$RMM+" ks.</strong><div class='flbet text-"+$RMMBavgInd[1]+"'>"+$RMMBavg+"<div class='logoright "+$RMMBavgInd[2]+"'></div></div></div></td>";
		//"<td colspan=3 style='color:#C00000;text-align:left'>+<strong>"+$RMM+"</strong></td>";
		ColRMA="<td colspan=2></td>"
		$("#TP_TblHarian tbody").prepend("<tr style='border-top:2px solid var(--dark)'>"+ColRMTgl+ColRMKB+ColNone+ColNone+ColRMSB+ColNone+ColNone+ColRMMB+ColNone+ColNone+ColRMA+"</tr>");
		$RMKy=$RMK; $RMSy=$RMS; $RMMy=$RMM;
		$RMK=0; $RMS=0; $RMM=0; $day=0;
	}
	PersAktfYest=PersAktf;
});
console.log(BulanTahun);
}
</script>
</body>
</html>
