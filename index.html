<!doctype html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<meta name="theme-color" content="#343a40">
	<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com/">
	<link rel="icon" href="../storage/media/icon.png" type="image/x-icon">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Expires" content="30"/>
	<noscript><meta http-equiv="refresh" content="0; url=../no-js.html"/></noscript>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" onload="if(media!='all')media='all'">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;400;500;700&display=swap" onload="if(media!='all')media='all'">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css" onload="if(media!='all')media='all'"/>
	<style>
body{font-family:"Roboto",sans-serif;}.chart-container{position:relative; min-width:100%; max-width:100%;}.logoinc::before {display:inline-block;content:"▲";font-size:14px;margin-right:4px;}.logodec::before {display:inline-block;content:"▼";font-size:14px;margin-right:4px;}
@media (max-width:576px) {.chart-container{max-height:45vh;}}
</style>
</head>
<body>
	<nav class="navbar navbar-dark sticky-top shadow bg-dark">
		<div class="container">
			<a class="navbar-brand text-truncate">
				JollyFrankle Projects: COVID-19 NTT Tracker
			</a>
		</div>
	</nav>
	<main class="container my-4">
<div class="d-block d-md-flex justify-content-between align-items-center mb-4">
	<div>
		<h1>COVID-19 NTT Tracking</h1>
		<p class="lead mb-0">Tracking Kasus COVID-19 NTT harian.</p>
	</div>
	<form method="GET" style="max-width:300px" class="m-md-0 m-auto">
		<label for="RangeSel">Jumlah hari untuk ditampilkan:</label>
		<div class="btn-group">
			<select name="day" class="form-control custom-select" id="RangeSel">
				<option value=365>1 tahun terakhir</option>
				<option value=180>180 hari terakhir</option>
				<option value=90>90 hari terakhir</option>
				<option value=60>60 hari terakhir</option>
				<option value=30>30 hari terakhir</option>
			</select>
			<input type="submit" class="btn btn-primary"/>
		</div>
	</form>
</div>
<div class="alert alert-danger text-justify">
	<p><strong>DISCLAIMER:</strong> Data yang ditampilkan pada halaman ini mungkin berbeda dengan data yang disediakan pada <a href="http://covid19.nttprov.go.id/home/data" class="alert-link">halaman resmi COVID-19 NTT</a> karena data yang direkam pada halaman ini diperbarui pada pukul 17.00 - 19.00 WITA, sedangkan data pada halaman resmi terkadang diperbarui lagi setelah 19.00 WITA. Selain itu, kasus sembuh dan meninggal tidak menunjukkan jumlah pasien yang sembuh/meninggal dari kasus pada tanggal tertentu, melainkan jumlah pasien yang diumumkan sembuh/meninggal pada hari itu juga. (Contoh: Apabila seseorang dinyatakan positif pada 19 Januari 2021 dan sembuh pada 1 Februari 2021, kasus sembuh akan bertambah pada 1 Februari 2021, bukan 19 Januari 2021).</p>
	<h5 class="mb-0">HALAMAN INI HANYA VISUALISASI PERKEMBANGAN KASUS COVID-19 DI NTT</h5>
</div>
<div class="alert alert-info text-center h6">
	Data per: <strong id="LastData">Memuat</strong><br/>
	<!--Terakhir diperbarui: <strong id="LastMod">Memuat</strong>-->
</div>
<div class="form-row">
	<div class="col-sm-6 col-lg-3 mb-3">
		<div class="card">
			<div style="background:#BF9000" class="pb-1"></div>
			<div class="card-body">
				<h5 class="card-title mb-1 text-truncate" style="color:#BF9000">Jumlah kasus positif</h5>
				<p class="display-4 mb-1" id="TB_JlhKonf">...</p>
				<hr class="my-1"/>
				<div class="d-flex justify-content-between text-muted">
					<span id="TB_JlhKonfYest">Memuat</span>
					<span class="logoinc" id="TB_JlhKonfInc">Memuat</span>
				</div>
			</div>
			<div class="bg-secondary pb-1"></div>
			<div class="card-body">
				Penambahan tertinggi <span class="GET_day-html"></span> hari:
				<div class="d-flex justify-content-between mb-2">
					<strong id="TBA_KonfHighest">...</strong>
					<small id="TBA_KonfHighestDate">Memuat</small>
				</div>
				Penambahan terendah <span class="GET_day-html"></span> hari:
				<div class="d-flex justify-content-between">
					<strong id="TBA_KonfLowest">...</strong>
					<small id="TBA_KonfLowestDate">Memuat</small>
				</div>
			</div>
		</div>
	</div>
	<div class="col-sm-6 col-lg-3 mb-3">
		<div class="card">
			<div style="background:#002060" class="pb-1"></div>
			<div class="card-body">
				<h5 class="card-title mb-1 text-truncate" style="color:#002060">Jumlah sembuh</h5>
				<p class="display-4 mb-1" id="TB_JlhSemb">...</p>
				<hr class="my-1"/>
				<div class="d-flex justify-content-between text-muted">
					<span id="TB_JlhSembYest">Memuat</span>
					<span class="logoinc" id="TB_JlhSembInc">Memuat</span>
				</div>
			</div>
			<div class="bg-secondary pb-1"></div>
			<div class="card-body">
				Penambahan tertinggi <span class="GET_day-html"></span> hari:
				<div class="d-flex justify-content-between mb-2">
					<strong id="TBA_SembHighest">...</strong>
					<small id="TBA_SembHighestDate">Memuat</small>
				</div>
				Penambahan terendah <span class="GET_day-html"></span> hari:
				<div class="d-flex justify-content-between">
					<strong id="TBA_SembLowest">...</strong>
					<small id="TBA_SembLowestDate">Memuat</small>
				</div>
			</div>
		</div>
	</div>
	<div class="col-sm-6 col-lg-3 mb-3">
		<div class="card">
			<div style="background:#C00000" class="pb-1"></div>
			<div class="card-body">
				<h5 class="card-title mb-1 text-truncate" style="color:#C00000">Jumlah meninggal</h5>
				<p class="display-4 mb-1" id="TB_JlhMeng">...</p>
				<hr class="my-1"/>
				<div class="d-flex justify-content-between text-muted">
					<span id="TB_JlhMengYest">Memuat</span>
					<span class="logoinc" id="TB_JlhMengInc">Memuat</span>
				</div>
			</div>
			<div class="bg-secondary pb-1"></div>
			<div class="card-body">
				Penambahan tertinggi <span class="GET_day-html"></span> hari:
				<div class="d-flex justify-content-between mb-2">
					<strong id="TBA_MengHighest">...</strong>
					<small id="TBA_MengHighestDate">Memuat</small>
				</div>
				Penambahan terendah <span class="GET_day-html"></span> hari:
				<div class="d-flex justify-content-between">
					<strong id="TBA_MengLowest">...</strong>
					<small id="TBA_MengLowestDate">Memuat</small>
				</div>
			</div>
		</div>
	</div>
	<div class="col-sm-6 col-lg-3 mb-3">
		<div class="card">
			<div style="background:#00B050" class="pb-1"></div>
			<div class="card-body">
				<h5 class="card-title mb-1 text-truncate" style="color:#00B050">Kasus aktif</h5>
				<p class="display-4 mb-1" id="TB_JlhAktif">...</p>
				<hr class="my-1"/>
				<div class="d-flex justify-content-between text-muted">
					<span id="TB_JlhAktifYest">Memuat</span>
					<span class="" id="TB_JlhAktifSelisih">Memuat</span>
				</div>
			</div>
		</div>
	</div>
</div>

<h4 class="text-center">Jumlah Kasus Positif, Sembuh, dan Meninggal Harian</h4>
<div class="chart-container" style="height:500px;width:600px;">
	<canvas id="ChartKonfirmasi"></canvas>
</div>

<hr class="my-2"/>
<h4 class="text-center">Pertambahan Kasus Positif Baru</h4>
<div class="chart-container" style="height:500px;width:600px;">
	<canvas id="ChartNewKonf"></canvas>
</div>

<hr class="my-2"/>
<h4 class="text-center">Pertambahan Kasus Sembuh</h4>
<div class="chart-container" style="height:500px;width:600px;">
	<canvas id="ChartNewSemb"></canvas>
</div>

<hr class="my-2"/>
<h4 class="text-center">Pertambahan Kasus Meninggal</h4>
<div class="chart-container" style="height:500px;width:600px;">
	<canvas id="ChartNewMeng"></canvas>
</div>

	</main>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
<script src="data.js"></script>
<script>
var url = new URL(window.location.href);
var GET_day = -url.searchParams.get("day");
var GET_day_plain = url.searchParams.get("day");
if(!GET_day) {var GET_day=-90; var GET_day_plain=90;}
$("#RangeSel").val(GET_day_plain);
const delay = ms => new Promise(res => setTimeout(res, ms));
const NamaBulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
const NamaHari = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];

const DefChartOpt = {
		tooltips: {
			enabled: true,
			mode: 'index',
			intersect: false,
			callbacks: {
				title: function(tooltipItems, data) {
					var tgl=new Date(tooltipItems[0].xLabel);
					return tgl.getDate()+" "+NamaBulan[tgl.getMonth()]+" "+tgl.getFullYear()+':';
				}
			}
		},
		hover: {
			mode: "nearest",
			intersect: true
		},
		elements: {
			point:{
				radius: 1
			}
		},
		maintainAspectRatio: false,
		aspectRatio: 1.5,
		defaultFontFamily: "Roboto",
		defaultFontSize: 14,
	};
var AktifJuml=[];
function DateIndo(date)
{
	var tgl=new Date(date);
	return tgl.getDate()+" "+NamaBulan[tgl.getMonth()]+" "+tgl.getFullYear();
}
$(document).ready(async function(){
	$.each(Tanggal.slice(GET_day),function(key,val){
		AktifJuml.push(KonfJuml.slice(GET_day)[key]-(SembJuml.slice(GET_day)[key]+MengJuml.slice(GET_day)[key]));
	});
	var JlhYestPre = "Kemarin: ";
	await delay(500);
	$("#TB_JlhKonf").text(KonfJuml[KonfJuml.length-1]);
	$("#TB_JlhKonfYest").text(JlhYestPre+KonfJuml[KonfJuml.length-2]);
	$("#TB_JlhKonfInc").text(KonfBaru[KonfBaru.length-1]);
	await delay(500);
	$("#TB_JlhSemb").text(SembJuml[SembJuml.length-1]);
	$("#TB_JlhSembYest").text(JlhYestPre+SembJuml[SembJuml.length-2]);
	$("#TB_JlhSembInc").text(SembBaru[SembBaru.length-1]);
	await delay(500);
	$("#TB_JlhMeng").text(MengJuml[MengJuml.length-1]);
	$("#TB_JlhMengYest").text(JlhYestPre+MengJuml[MengJuml.length-2]);
	$("#TB_JlhMengInc").text(MengBaru[MengBaru.length-1]);
	await delay(500);
	var SelisihAktif = AktifJuml[AktifJuml.length-1]-AktifJuml[AktifJuml.length-2];
	if(SelisihAktif<0) SelAkInd="logodec"; else SelAkInd="logoinc";
	$("#TB_JlhAktif").text(AktifJuml[AktifJuml.length-1]);
	$("#TB_JlhAktifYest").text(JlhYestPre+(AktifJuml[AktifJuml.length-2]));
	$("#TB_JlhAktifSelisih").text(SelisihAktif).addClass(SelAkInd);

	$("#LastData").text(DateIndo(Tanggal[Tanggal.length-1]));
	//$("#LastMod").text(Tanggal[Tanggal.length-1]);

	await delay(500);
	$(".GET_day-html").text(GET_day_plain);
	var $Arr_day=KonfBaru.slice(GET_day),
	IndexH=Object.keys($Arr_day).reduce((a, b) => $Arr_day[a] > $Arr_day[b] ? a : b),
	IndexL=Object.keys($Arr_day).reduce((a, b) => $Arr_day[a] < $Arr_day[b] ? a : b);
	$("#TBA_KonfHighest").text($Arr_day[IndexH]);
	$("#TBA_KonfHighestDate").text(DateIndo(Tanggal.slice(GET_day)[IndexH]));
	$("#TBA_KonfLowest").text($Arr_day[IndexL]);
	$("#TBA_KonfLowestDate").text(DateIndo(Tanggal.slice(GET_day)[IndexL]));

	await delay(500);
	var $Arr_day=SembBaru.slice(GET_day),
	IndexH=Object.keys($Arr_day).reduce((a, b) => $Arr_day[a] > $Arr_day[b] ? a : b),
	IndexL=Object.keys($Arr_day).reduce((a, b) => $Arr_day[a] < $Arr_day[b] ? a : b);
	$("#TBA_SembHighest").text($Arr_day[IndexH]);
	$("#TBA_SembHighestDate").text(DateIndo(Tanggal.slice(GET_day)[IndexH]));
	$("#TBA_SembLowest").text($Arr_day[IndexL]);
	$("#TBA_SembLowestDate").text(DateIndo(Tanggal.slice(GET_day)[IndexL]));

	await delay(500);
	var $Arr_day=MengBaru.slice(GET_day),
	IndexH=Object.keys($Arr_day).reduce((a, b) => $Arr_day[a] > $Arr_day[b] ? a : b),
	IndexL=Object.keys($Arr_day).reduce((a, b) => $Arr_day[a] < $Arr_day[b] ? a : b);
	$("#TBA_MengHighest").text($Arr_day[IndexH]);
	$("#TBA_MengHighestDate").text(DateIndo(Tanggal.slice(GET_day)[IndexH]));
	$("#TBA_MengLowest").text($Arr_day[IndexL]);
	$("#TBA_MengLowestDate").text(DateIndo(Tanggal.slice(GET_day)[IndexL]));

var C_konf = document.getElementById('ChartKonfirmasi').getContext('2d');
var C_NewKonf = document.getElementById('ChartNewKonf').getContext('2d');
var C_NewSemb = document.getElementById('ChartNewSemb').getContext('2d');
var C_NewMeng = document.getElementById('ChartNewMeng').getContext('2d');
await delay(1000);
var ChartKonfirmasi = new Chart(C_konf, {
	type: 'line',
	data: {
		labels: Tanggal.slice(GET_day),
		datasets: [{
			label: 'Terkonfirmasi',
			data: KonfJuml.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#BF9000',
			borderWidth: 1
		},
		{
			label: 'Sembuh',
			data: SembJuml.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#002060',
			borderWidth: 1
		},
		{
			label: 'Meninggal',
			data: MengJuml.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#C00000',
			borderWidth: 1
		}]
	},
	options: DefChartOpt 
});
await delay(1000);
var ChartNewKonf = new Chart(C_NewKonf, {
	type: 'line',
	data: {
		labels: Tanggal.slice(GET_day),
		datasets: [{
			label: 'Penambahan',
			data: KonfBaru.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#BF9000',
			borderWidth: 2
		},
		{
			label: 'Rata-rata 7 hari',
			data: Konf7day.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#3B3838',
			borderWidth: 1
		}]
	},
	options: DefChartOpt 
});
await delay(1000);
var ChartNewSemb = new Chart(C_NewSemb, {
	type: 'line',
	data: {
		labels: Tanggal.slice(GET_day),
		datasets: [{
			label: 'Penambahan',
			data: SembBaru.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#002060',
			borderWidth: 2
		},
		{
			label: 'Rata-rata 7 hari',
			data: Semb7day.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#3B3838',
			borderWidth: 1
		}]
	},
	options: DefChartOpt 
});
await delay(1000);
var ChartNewMeng = new Chart(C_NewMeng, {
	type: 'line',
	data: {
		labels: Tanggal.slice(GET_day),
		datasets: [{
			label: 'Penambahan',
			data: MengBaru.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#C00000',
			borderWidth: 2
		},
		{
			label: 'Rata-rata 7 hari',
			data: Meng7day.slice(GET_day),
			backgroundColor: 'rgba(0,0,0,0)',
			borderColor: '#3B3838',
			borderWidth: 1
		}]
	},
	options: DefChartOpt 
});
});
</script>
</html>
